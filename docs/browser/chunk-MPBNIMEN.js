import{a as k}from"./chunk-T65ZH34U.js";import{a as I}from"./chunk-BG5OABPD.js";import{a as y}from"./chunk-UIAZK7O4.js";import{a as u}from"./chunk-WXQINL7T.js";import"./chunk-L34VEILA.js";import{a as w}from"./chunk-SEHDV2E7.js";import{a as N}from"./chunk-STAKAPIY.js";import"./chunk-RUDA2RPX.js";import{a as F}from"./chunk-O7TQW4TT.js";import{i as P}from"./chunk-Y2FNOCH7.js";import"./chunk-4BQZLGFG.js";import"./chunk-MHD2J2H6.js";import{d as h,g as x,h as M,k as b,n as R,t as E}from"./chunk-F6QTPZUH.js";import"./chunk-R7NQQTEA.js";import{e as _}from"./chunk-ISKXA73K.js";import"./chunk-DBXTAN6W.js";import"./chunk-ZESSTKUQ.js";import{Cb as o,Db as a,Eb as f,F as p,Lb as g,Wa as s,Xb as m,ab as r,hb as C,mb as S,tb as l,wa as v,yb as O}from"./chunk-KXY2N67X.js";import"./chunk-4CLCTAJ7.js";var j={4:"Token inv\xE1lido ou expirado.",5:"Este e-mail j\xE1 foi confirmado.",token:"O token n\xE3o pode ser vazio."};var T={6:"E-mail n\xE3o encontrado.",7:"O e-mail j\xE1 foi verificado.",email:"O e-mail n\xE3o pode ser vazio."};function L(c,z){c&1&&(o(0,"div",1),f(1,"img",13),a())}var re=(()=>{class c{constructor(t,i,e,n,d,D){this.registrationService=t,this.router=i,this.notificationService=e,this.tempStorageService=n,this.formValidation=d,this.screenService=D,this.isLoading=v(!1),this.isMobile=!1,this.confirmForm=new M({token:this.formValidation.createFormControl("",[h.required,h.pattern(this.formValidation.patterns.confirmationCode)])})}ngOnInit(){this.screenService.isMobile$.subscribe(t=>{this.isMobile=t})}onConfirm(){if(this.confirmForm.invalid)return;this.isLoading.set(!0);let{token:t}=this.confirmForm.value,i={token:Number(t),email:this.tempStorageService.getEmail()};this.registrationService.confirmRegistration(i).pipe(p(()=>this.isLoading.set(!1))).subscribe({next:()=>{this.notificationService.showSuccess("Conta confirmada com sucesso! Fa\xE7a login para continuar."),this.router.navigate(["/auth/login"])},error:e=>{let n=e?.error?.code||e?.error?.field||"500",d=j[n]||u[n]||"Erro desconhecido.";this.notificationService.showError(d)}})}onResendToken(){let t=this.tempStorageService.getEmail();if(!t){this.notificationService.showError("Erro: Nenhum e-mail encontrado. Fa\xE7a o cadastro novamente.");return}this.isLoading.set(!0),this.registrationService.resendConfirmation({email:t}).pipe(p(()=>this.isLoading.set(!1))).subscribe({next:()=>this.notificationService.showSuccess("Novo c\xF3digo enviado para seu e-mail."),error:i=>{let e=i?.error?.code||i?.error?.field||"500",n=T[e]||u[e]||"Erro desconhecido.";this.notificationService.showError(n)}})}static{this.\u0275fac=function(i){return new(i||c)(r(k),r(_),r(P),r(I),r(F),r(N))}}static{this.\u0275cmp=C({type:c,selectors:[["app-confirm"]],decls:17,vars:6,consts:[[1,"confirm-container"],[1,"confirm-left"],[1,"confirm-right"],[1,"confirm-card"],[1,"logo-section"],["src","logo.svg","alt","Stonkz Logo",1,"logo"],[1,"confirm-title"],[1,"confirm-subtitle"],[3,"ngSubmit","formGroup"],["label","C\xF3digo","placeholder","Digite o c\xF3digo","type","text","mask","000-000",3,"control"],[3,"label","disabled","loading"],[1,"resend-text"],[1,"resend-link",3,"click"],["src","register/confirm.svg","alt","confirm Image",1,"confirm-image"]],template:function(i,e){i&1&&(o(0,"div",0),S(1,L,2,0,"div",1),o(2,"div",2)(3,"section",3)(4,"div",4),f(5,"img",5),a(),o(6,"h2",6),m(7,"Confirme seu cadastro"),a(),o(8,"p",7),m(9," Digite o c\xF3digo que enviamos para o seu e-mail. "),a(),o(10,"form",8),g("ngSubmit",function(){return e.onConfirm()}),f(11,"app-input",9)(12,"app-button",10),a(),o(13,"p",11),m(14," N\xE3o recebeu o c\xF3digo? "),o(15,"a",12),g("click",function(){return e.onResendToken()}),m(16,"Reenviar"),a()()()()()),i&2&&(s(),O(e.isMobile?1:-1),s(9),l("formGroup",e.confirmForm),s(),l("control",e.confirmForm.controls.token),s(),l("label","Confirmar")("disabled",e.confirmForm.invalid||e.isLoading())("loading",e.isLoading()))},dependencies:[E,b,x,R,y,w],styles:['@charset "UTF-8";.F-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;min-height:100vh;width:100%;overflow:hidden}.confirm-left[_ngcontent-%COMP%]{flex:7;display:flex;justify-content:center;position:relative}.confirm-right[_ngcontent-%COMP%]{flex:3;display:flex;align-items:center;justify-content:center;height:100vh;overflow-y:auto}.logo-section[_ngcontent-%COMP%]{display:flex;justify-content:left;margin-bottom:20px}.logo[_ngcontent-%COMP%]{width:163px;height:42px;object-fit:contain}.confirm-image[_ngcontent-%COMP%]{width:100%;height:100vh;object-fit:cover;object-position:top}.confirm-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:24px;text-align:center}.confirm-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:grid;row-gap:16px}.confirm-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:10px;text-align:left}.confirm-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-bottom:20px;text-align:left}.resend-text[_ngcontent-%COMP%]{margin-top:15px;font-size:14px}.resend-link[_ngcontent-%COMP%]{color:var(--color-primary);cursor:pointer;font-weight:500}.resend-link[_ngcontent-%COMP%]:hover{opacity:.7}@media (max-width: 768px){.confirm-container[_ngcontent-%COMP%]{flex-direction:column}.confirm-left[_ngcontent-%COMP%]{display:none}.confirm-right[_ngcontent-%COMP%]{align-items:flex-start;margin-top:24px;width:100%;height:auto}.confirm-card[_ngcontent-%COMP%]{padding:15px}}']})}}return c})();export{re as ConfirmComponent};
